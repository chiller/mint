<html>
<head>
    <style>

#wrapper { 
    height: 100%; 
    width:400px;
}
#content {
    height: 400px;
    overflow: scroll;
}
#footer {
    background-color: #FFCCCC;
    height: 50px;
    
}
#message{
    height:50px;
    width: 340px;
}
#btn{
    height:50px;
    width: 50px;
}

#draggable { width: 150px; height: 150px; padding: 0.5em; background-color: #FFAACC;    position: fixed; 
}

    </style>

    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://raw.github.com/FrancisShanahan/Identicon5/master/jquery.identicon5.js"></script> 
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
  
    <script>
    function log(text){
        var _body = $('#stuff');
        _body.append("<p><span class='random'>" + text.sender + "</span>" + text.hello + "</p>")

        var objDiv = document.getElementById("content");
        objDiv.scrollTop = objDiv.scrollHeight;
        $(".random").identicon5()
        $(".random").removeClass("random")
    }

    window.onload = function() {
      socket = io.connect('/');
      socket.on('news', function (data) {
        log(data)
        
      });
      socket.on('chat', function(data) {
        log(data);
      })

      socket.on('collab', function(data) {
        console.log(data.shape);
        window.shape = data.shape
        $("#draggable").css("left",data.shape.x + "px")
        $("#draggable").css("top",data.shape.y + "px")

      })

      $("#message").keyup(function (e) {
        if (e.keyCode == 13) {
            chat()
        }
        });

      $("#draggable").draggable({

        stop: function( event, ui ) {
            window.shape.x = parseInt( $(this).css("left"), 10)
            window.shape.y = parseInt( $(this).css("top"), 10)
            socket.emit("collab", {shape: window.shape})
        }
      })

    }

    function chat() {
        socket.emit("chat", {hello: $("#message").val()});
        $("#message").val("")
    }
    
    </script>
</head>
<body>

    <div id="wrapper">
        <div id="content">
            <div id="top-padding"></div>
            <div id="stuff">
                
            </div>
            <div id="bottom-padding"></div>
        </div><!-- content -->
        
         <div id="footer" class="border1">    
                <input id="message" type="text"></input>
                <button id="btn" onclick="chat()">Send</button>
        </div>

    </div><!-- wrapper -->
    <div id="draggable" class="ui-widget-content">
        <p>Drag me around</p>
    </div>
   
       
    
</body>
</html>